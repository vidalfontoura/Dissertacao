\chapter{Experimentos}

Neste capítulo serão apresentados  os experimentos para avaliar e validar as duas estratégias apresentadas no Capítulo \ref{cap:Metodologia}. Também são apresentadas as instâncias de \textit{benchmark} para o problema PDP com o modelo HP-2D que foram utilizadas nos experimentos.



Um  total de 11 instâncias foram selecionadas  dos trabalhos relacionados \cite{unger1993genetic,krasnogor2002multimeme,shmygelska2002ant,shmygelska2003improved,hsu2003growth} para compor um conjunto de \textit{benchmark}. Este conjunto foi utilizado para avaliar as estratégias propostas. A Tabela \ref{tab:instancias} apresenta o tamanho, o melhor valor de energia conhecido e a fórmula da sequência de aminoácidos do modelo HP. Tanto os AEMOs e o EGHyPDP foram submetidos a esse conjunto de instâncias o qual possui diferentes níveis de complexidade. Todos os experimentos realizados nesta dissertação foram executados 30 vezes por conta do comportamento estocástico inerente às heurísticas utilizadas. Por conta das múltiplas execuções em casos que forem necessários serão apresentados os valores de média, desvio padrão, minimo e máximo referente as execuções.

%TODO: COLOCAR O HARDWARE EM QUE FOI EXECUTADO OS EXPERIMENTOS


Este capítulo esta divido em duas seções para melhor apresentar os resultados obtidos por cada uma das estratégias propostas. A primeira seção descreve os experimentos realizados para avaliar a aplicação de AEMOs para o PDP utilizando o modelo HP-2D. A segunda seção apresenta os experimentos realizados para avaliar a habilidade do EGHyPDP para gerar heurísticas de alto nível para um \textit{framework} hiper heurístico, utilizando um procedimento de evolução gramatical.



 
\begin{table}[]
	\centering
	\caption{Instâncias de \textit{benchmark} utilizadas nos experimentos.}
	\label{tab:instancias}
	
	\resizebox{\columnwidth}{!}{%
	\begin{tabular}{cccc}
		Instância & Tamanho & \multicolumn{1}{l}{Melhor Valor de Energia} & Fórmula HP                                                                                                                                                                          \\ \hline
	1       & 20      & -9                          & $HPHPPHHPHHPHPHHPPHPH$                                                                                                                                                               \\ \hline
	2       & 24      & -9                          & $HHPPHPPHPPHPPHPPHPPHPPHH $                                                                                                                                                           \\ \hline
		3       & 25      & -8                          & $PPHPPHHP^4HHP^4HHP^4HH$                                                                                                              \\ \hline
		4       & 36      & -14                         & $P^3HHPPHHP^5H^7PPHHP^4HHPPHPP$                                                                                       \\ \hline
		s5       & 48      & -23                         & $PPHPPHHPPHHP^5H^{10}P^6HHPPHHPPHPPH^5$                                                                             \\ \hline
		6       & 50      & -21                         & $HHPHPHPHPH^4PHP^3HP^3HP^4HP^3HP^3HPH^4{{PH}}^4H$ \\ \hline
		7       & 60      & -36                         & $PPH^3PH^8P^3H^{10}PHP^3H^{12}P^4H^6PHHPHP$      \\ \hline
		8       & 64      & -42                         & $H^{12}PHPH{{PPHH}}^2PPH{{PPHH}}^2PPH{{PPHH}}^2PPHPHPH^{12}$                          \\ \hline
		9       & 85      & -53                         & $H^4P^4H^{12}P^6H^{12}P^3H^12P^3H^12P^3HP^2H^2P^2H^2P^2HPH$      \\ \hline
		10      & 100     & -48                         & $P^6HPH^2P^5H^3PH^5PH^2P^4H^2P^2H^2PH^5PH^10PH^2PH^7P^11H^7P^2HP^3P^6HPH$         \\ \hline
		11      & 100     & -50                         & $P^3H^2P^2H^4P^2H^3PH^2PH^2PH^4P^8H^6P^2H^6P^9HPH^2PH^11P^2H^3PH^2PHP^2HPH^3P^6H^3$ \\ \hline
	
	\end{tabular}
	}	
\end{table}












\section{Resultados dos AEMOs aplicados ao PDP}

Nesta seção serão apresentados o cojunto de experimentos realizados utilizando a abordagem multi-objetiva com os algoritmos NSGAII e IBEA. Inicialmente, serão apresentadas as configurações utilizadas nos algoritmos. Em seguida, uma comparação entre os resultados de cada algoritmo é apresentada. Finalmente, uma comparação com os resultados dos trabalhos relacionados que tratam o problema de maneira mono-objetiva é apresentada.




As configurações utilizadas nos AEMOs foi definida baseada no tamanho das instâncias. Para instâncias menores o tamanho da população e a numero máximo de avaliações são menores. Já para as sequências maiores os valores utilizados são superiores. A Tabela \ref{tab:popConfiguration} apresenta para cada instância: o tamanho da instância, o tamanho da população e número máximo de avaliações.TODO: ver como colocar essa aprte, tem que explicar as abordagens na metodologia In the case of the first approach, the probability of crossover/mutation occurrence was fixed, for all sequences, to 0.9 and 0.01 respectively. The second approach does not use a probability since the operators are always applied to generate new individuals. 
No caso do algoritmo IBEA a população auxiliar foi mantida em 200 para todas as instâncias.


\begin{table}[!htb]
	\centering
	\caption{Tamanho da população, número máximo de avaliações para cada instância}
	\label{tab:popConfiguration}
	\begin{tabular}{ccccl}
		\hline
		Instância & Tamanho & \begin{tabular}[c]{@{}c@{}}Tamanho  \\ 	População\end{tabular} & \begin{tabular}[c]{@{}c@{}}N Max Avaliações \\ \end{tabular} & \multicolumn{1}{c}{} \\ \hline
		1      & 20   & 100                                                        & 25000                                                      &                      \\ \hline
		2      & 24   & 100                                                        & 25000                                                      &                      \\ \hline
		3      & 25   & 500                                                        & 250000                                                     &                      \\ \hline
		4      & 36   & 500                                                        & 250000                                                     &                      \\ \hline
		5      & 48   & 1000                                                       & 2500000                                                    &                      \\ \hline
		6      & 50   & 1000                                                       & 2500000                                                    &                      \\ \hline
		7      & 60   & 2500                                                       & 2500000                                                    &                      \\ \hline
		8      & 64   & 2500                                                       & 2500000                                                    &                      \\ \hline
		9     &  85   & 2500                                                       & 2500000                                                    &                      \\ \hline
		10     &  100   & 3500                                                       & 3500000                                                    &                      \\ \hline
		11     &  100   & 3500                                                       & 3500000                                                    &                      \\ \hline
	\end{tabular}
\end{table}


Conforme mencionado no Capítulo \ref{cap:Metodologia} o indicador \textit{hypervolume} foi utilizado para comparar o desempenho dos AEMOs. Para cada algoritmo a média e o desvio padrão do \textit{hypervolume}  referente a 30 execuções é apresentada na Tabela \ref{tab:hypervolumeResults}. Os maiores valores estão em negrito e indicam uma maior aproximação da fronteira de Pareto \cite{barr1998economics}.

Observando a Tabela \ref{tab:hypervolumeResults} é possível notar que, exceto para a instância $1$, para todas outras instâncias o algoritmo M\_IBEA (versão modificada \textit{backtrack} e um \textit{pool} de operadores) obteve a maior média de \textit{hypervolume}. No caso da instância $1$, o IBEA sem modificações obteve a média mais alta. Também vale mencionar, que quando comparando apenas o NSGAII e o M\_NSGAII, a versão modificada obteve as melhores médias. De maneira geral, os AEMOs com \textit{backtrack} e o \textit{pool} de operadores (M\_IBEA and M\_M_NSGAII) apresentaram uma melhoria considerável em relação aos AEMOs tradicionais. Na Tabela \ref{tab:hypervolumeResults}, as células do M\_IBEA que estão marcados de cinza apresentaram diferença estatística de acordo com o teste de  Kruskal-Wallis \cite{mckight2010kruskal} entre M\_IBEA e todos os outros algoritmos (NSGAII, M\_NSGAII e IBEA).


\begin{table}[]
	\centering
	\caption{Resultado de média/desvio padrão dos AEMOs}
	\label{tab:hypervolumeResults}
	\begin{tabular}{|c|c|c|c|c|}
		\hline
		\multirow{2}{*}{Instância} & \multicolumn{4}{c|}{\begin{tabular}[c]{@{}c@{}}\textit{Hypervolume} Média\\ (Desvio padrão)\end{tabular}} \\ \cline{2-5} 
		& NSGAII            & M\_NSGAII         & IBEA                     & M\_IBEA                 \\ \hline
		\multirow{2}{*}{1}      & 0.742827          & 0.720864          & \textbf{0.789712}        & 0.786571       \\
		& (0.106315)        & (0.131351)        & (0.067660)               & (0.099424)              \\ \hline
		\multirow{2}{*}{2}      & 0.680572          & 0.712275          & 0.719960                 & \textbf{0.737086}       \\
		& (0.083445)        & (0.137226)        & (0.080727)               & (0.095299)              \\ \hline
		\multirow{2}{*}{3}      & 0.671171          & 0.709898          & 0.716438                 & \textbf{0.738017}       \\
		& (0.129417)        & (0.124201)        & (0.148112)               & (0.155638)              \\ \hline
		\multirow{2}{*}{4}      & 0.702280          & 0.740153          & 0.751755                 & \textbf{0.785728}       \\
		& (0689832)         & (0.075271)        & (0.092427)               & (0.055607)              \\ \hline
		\multirow{2}{*}{5}      & 0.707654          & 0.758128          & 0.733464                 & \cellcolor[HTML]{C0C0C0}\textbf{0.807637}       \\
		& (0.082611)        & (0.062315)        & (0.128757)               & \cellcolor[HTML]{C0C0C0}(0.039620)              \\ \hline
		\multirow{2}{*}{6}      & 0.667771          & 0.774017          & 0.728699                 & \cellcolor[HTML]{C0C0C0}\textbf{0.821177}       \\
		& (0.132218)        & (0.063231)        & (0.080679)               & \cellcolor[HTML]{C0C0C0}(0.048124)              \\ \hline
		\multirow{2}{*}{7}      & 0.784483          & 0.792843          & 0.801778                 & \textbf{0.810351}       \\
		& (0.063257)        & (0.033062)        & (0.067111)               & (0.054576)              \\ \hline
		\multirow{2}{*}{8}      & 0.677464          & 0.705798          & 0.7450656                & \cellcolor[HTML]{C0C0C0}\textbf{0.811439}       \\
		& (0.041287)        & (0.053048)        & (0.036454)               & \cellcolor[HTML]{C0C0C0}(0.050087)              \\ \hline
		
		
			\multirow{2}{*}{9}      & 0.687454          & 0.710798          & 0.7150656                & \cellcolor[HTML]{C0C0C0}\textbf{0.771439}       \\
			& (0.041287)        & (0.043546)        & (0.026561)               & \cellcolor[HTML]{C0C0C0}(0.044087)              \\ \hline
			  
		  
		  \multirow{2}{*}{10}      & 0.650798          & 0.690891         & 0.7250126                & \cellcolor[HTML]{C0C0C0}\textbf{0.761439}       \\
		  & (0.062157)        & (0.033661)        & (0.031211)               & \cellcolor[HTML]{C0C0C0}(0.013186)              \\ \hline
		  
		  
		  
		   
		   \multirow{2}{*}{11}      & 0.630496          & 0.670812         & 0.713126                & \cellcolor[HTML]{C0C0C0}\textbf{0.752445}       \\
		   & (0.052751)        & (0.031235)        & (0.053422)               & \cellcolor[HTML]{C0C0C0}(0.042326)              \\ \hline
	\end{tabular}
\end{table}


\subsection{Comparação com outras abordagens mono-objetivas}
Esta subseção apresenta a comparação dos resultados obtidos pelas melhores variantes de cada AEMO com outras abordagens mono-objetivas propostas em trabalhos anteriores. Os trabalhos comparados são: GA \cite{unger1993genetic}, MMA \cite{krasnogor2002multimeme}, ACO \cite{shmygelska2002ant},  NewACO \cite{ shmygelska2003improved} e PERM \cite{hsu2003growth}. Todos os trabalhos mencionados tratam-se de abordagens mono-objetivas, considerando apenas o valor de energia referente as estruturas de proteínas. A Tabela \ref{tab:comparison} apresenta os melhores resultados, em termos da energia, pelas versões modificadas dos AEMOs, assim como os melhores resultados obtidos pelos estudos anteriores.




\begin{table}[htb]
	\centering
	\caption{Comparação dos melhores AEMOs com o estudos anteriores do PDP}
	\label{tab:comparison}
	\begin{tabular}{ccccccccc}
		\hline
		Instância                   & M\_IBEA      & M\_NSGAII    & \begin{tabular}[c]{@{}c@{}}EDA \\ 
		
		\end{tabular}           & 
		
		\begin{tabular}[c]{@{}c@{}}GA \\ 
		
		\end{tabular}   
		
		& 	\begin{tabular}[c]{@{}c@{}} MMA \\ 
			  
		\end{tabular}        
		&
		\begin{tabular}[c]{@{}c@{}}  ACO \\ 
			
		\end{tabular} 
		& 
		\begin{tabular}[c]{@{}c@{}}  NewACO\\ 
			
		\end{tabular}
		& 
		\begin{tabular}[c]{@{}c@{}}  PERM\\ 
			 
		\end{tabular}
		\\ \hline
		1                     & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  \\ \hline
		2                     & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  & \textbf{-9}  \\ \hline
		3                     & \textbf{-8}  & \textbf{-8}  & \textbf{-8}  & \textbf{-8}  & \textbf{-8}  & \textbf{-8}  & \textbf{-8}  & \textbf{-8}  \\ \hline
		\multicolumn{1}{c}{4} & \textbf{-14}          & -13          & \textbf{-14} & \textbf{-14} & \textbf{-14} & \textbf{-14} & \textbf{-14} & \textbf{-14} \\ \hline
		\multicolumn{1}{c}{5} & \textbf{-23} & -22          & \textbf{-23} & -22          & -22          & \textbf{-23} & \textbf{-23} & \textbf{-23} \\ \hline
		\multicolumn{1}{c}{6} & \textbf{-21} & \textbf{-21} & \textbf{-21} & \textbf{-21} &              & \textbf{-21} & \textbf{-21} & \textbf{-21} \\ \hline
	
		\multicolumn{1}{c}{7} & -35          & -34          & -35          & -34          &              & -34          & \textbf{-36} & \textbf{-36} \\ \hline
	
	\multicolumn{1}{c}{8}                     & \textbf{-42} & -39          & \textbf{-42} & -37          &              & -32          & \textbf{-42} & -38          \\ \hline
		
		9                    & -49 & -44          & -52 & -37          &              & -32          & -52 & \textbf{-53}          \\ \hline
		
		10                    & -43 & -39          & -47 &          &              &           & -47 & \textbf{-48}          \\ \hline
		
		11                    & -41 & -37          & -48  &          &              &           & -47 & \textbf{-50}          \\ \hline
	\end{tabular}
\end{table}

No caso das 3 primeiras instâncias $1$, $2$ e $3$ a versões modificadas dos AEMOs (M\_NSGAII e M\_IBEA) obtiveram os mesmos valores mínimos de energia que os estudos  anteriores considerados nesta comparação. No caso da instância $4$, exceto pelo algoritmo M\_NSGAII, todos os outros atingiram o valor de -14. Já no caso da instância $5$ o algoritmo M\_IBEA e 4 algoritmos mono-objetivo obtiveram o valor ótimo de 23. Entretanto, M\_NSGAII e os demais algoritmos obtiveram um valor inferior de -22.    

Já no caso da instância $6$ todos os algoritmos obtiveram o valor ótimo de -21. Para a instância $7$ o algoritmo M\_IBEA obteve -35 da mesma maneira que o EDA. Entretanto o valor ótimo para sequência $7$ é -36 e foi obtido pelo NewACO e PERM. Para a instância $8$ o algoritmo M\_IBEA obteve o valor ótimo -42 mesmo valor que o EDA  e NewACO. Todos as outras abordagens obtiveram valores inferiores. No caso das instâncias 9,10 e 11, as maiores, apenas o algoritmo PERM conseguiu obter os melhores resultados. Estas instâncias são as mais complexas devido ao seu tamanho. Dessa maneira, os algoritmos tendem a ficar presos em mínimos locais. Consequentemente, nestes casos os algoritmos necessitam de mecanismos inteligentes para escapar de mínimos locais e guiar a busca para regiões promissoras.

Após analisar os resultados foi possível constatar que apenas um AEMO, o M\_IBEA conseguiu encontrar os melhores resultados para 7 instâncias de 11. Entretanto, nas instâncias mais complexas seu desempenho é degradado. Já os outros AEMOs propostos não tiveram resultados expressivos.

\subsection{Conclusão dos experimentos utilizando os AEMOs}

AEMOs são algoritmos evolucionários que visam a otimização de múltiplos objetivos ao mesmo tempo. Estes apresentam bons resultados quando aplicados a problemas de várias áreas da ciência.  Nestes experimentos dois AEMOs foram aplicados ao problema PDP utilizando o modelo HP-2D. Duas abordagens multi-objetivas foram apresentadas: a primeira utiliza as versões padrão dos algoritmos IBEA e NSGAII; a segunda abordagem consistiu em modificar o IBEA e NSGAII adicionando a inicialização com \textit{backtrack} e o \textit{pool} de operadores, com objetivo de melhorar os resultados. Dado os resultados se tornou claro que as versões modificadas dos algoritmos tem uma maior habilidade em explorar o espaço de busca quando comparados com as versões padrão.  

Também foi possível verificar que a abordagem multi-objetiva utilizando o NSGAII e o M\_NSGAII também não apresentou resultados satisfatórios, tanto em termos de \textit{hypervolume} como valores de energia,  quando comparado com o IBEA e a versão modificada. Mesmo a versão padrão de IBEA obteve melhores resultados do que ambas as versões do NSGAII. Porém, a versão modificada M\_IBEA apresentou os melhores resultados dentre os outros AEMOs propostos. Isto sugere que apenas uma formulação multi-objetiva não é suficiente para atingir bons resultados em termos de energia das estruturas. Com a inicialização via \textit{backtrack}, \textit{pool} de operadores e a maneira sofisticada de explorar o espaço de busca multi-objetivo do IBEA poderão possibilitar resultados promissores.

Dado os resultados é indiscutível que o algoritmo M\_IBEA foi capaz de escapar dos mínimos locais em vários os casos, exceto para as instâncias 7,9,10 e 11. Estas instâncias são as mais complexas e muitas propostas não conseguem obter os melhores resultados. Dentre  os trabalhos relacionados apenas o PERM consegue  explorar o espaço de busca o suficiente para encontrar os melhores resultados.

Também vale mencionar que os parâmetros para os algoritmos não foram \textit{tunados} e que existe uma chance de obterem melhores resultados caso um procedimento de \textit{tunning} seja feito.

Os resultados obtidos pelo M\_IBEA abrem um amplo campo de possibilidades para aprofundar formulações multi-objetivas para o problema PDP com o modelo HP-2D ou até mesmo o HP-3D. As descobertas desta dissertação motivam pesquisas adicionais utilizando abordagens multi-objetivas e adição de um \textit{pool} de operadores com objetivo de aprimorar a habilidade de escapar de mínimos locais. No caso de formulações multi-objetiva é possível mencionar que o \textit{design} de abordagens inovadoras como o uso de métricas para avaliar o grau de compactação das conformações de proteínas ou outros métodos que considerem diferentes fatores, podem aprimorar os AEMOs e possibilitar que melhores resultados sejam obtidos.



\section{Resultados obtidos com EGHyPDP}

Nesta seção, serão discutidos  os experimentos conduzidos com objetivo de avaliar se o \textit{design} automático de heurísticas de alto nível para um \textit{framework} hiper-heurístico. Este \textit{framework} foi aplicado ao PDP para avaliar seu desempenho. A implementação do EGHyPDP ocorreu durante o período de desenvolvimento desta dissertação. 


Três grupos de experimentos foram desenvolvidos e executados. O primeiro grupo de experimentos tratou apenas de gerar mecanismos de seleção. O segundo grupo foi desenvolvido com objetivo de gerar apenas critérios de aceitação. E por último o terceiro grupo foi desenvolvido com intuito de gerar em paralelo tanto mecanismos de seleção como critérios de aceitação.

O tempo de execução total destes 3 grupos de experimentos foi de 28 dias. Após a execução dos experimentos os resultados obtidos por cada grupo foram comparados entre si. Porém esta comparação não foi suficiente para avaliar a capacidade das heurísticas de alto nível. \cite{misir2012intelligent} nos forneceu o código fonte utilizado em seu estudo e isto possibilitou a execução do GIHH (Generic Intelligent Hyper-heuristic) no contexto do PDP com o modelo HP-2D. O GIHH obteve resultados impressionantes em outros problemas de \textit{benchmark}. Portanto, a comparação dos resultados em relação aos obtidos por uma estratégia hiper heurística (do estado da arte) desenvolvida por um pesquisador foi realizada.   	. 

O primeiro grupo de experimentos denominado, EGHyPDP-1, apenas gerou mecanismos de seleção. O critério de aceitação foi configurado e mantido fixo com uma estratégia que aceita apenas soluções melhores ou iguais \cite{burke2013hyper}. O objetivo deste grupo é avaliar a habilidade da abordagem proposta em gerar mecanismos de seleção utilizando um critério de aceitação fixo.

	O segundo grupo de experimentos, EGHyPDP-2, consistiu em gerar apenas critérios de aceitação. O mecanismo de seleção foi configurado e mantido fixo utilizando o melhor mecanismos de seleção gerado pelo experimento EGHyPDP-1. Consequentemente, este experimento depende da saída do primeiro grupo. O objetivo deste experimento é avaliar a qualidade dos critérios de aceitação gerados, separadamente do mecanismo de seleção o qual foi mantido fixo.
	
	O terceiro grupo de experimentos,  EGHyPDP-3, foi desenvolvido para gerar tanto mecanismos de seleção e critérios de aceitação ao mesmo tempo. Este grupo avalia a habilidade em gerar mecanismos de seleção em conjunto com critérios de aceitação. Diferentemente do grupo EGHyPDP-2  , este grupo não depende de nenhuma saída dos experimentos anteriores.

% since it
%generates both mechanisms without fixing any component.
	Para cada grupo de experimentos a fase de treino consistiu em executar o processo da evolução gramatical. Foram utilizadas 3  instâncias (2,5 e 10 da Tabela \ref{tab:instancias}), com diferentes complexidades, na função de \textit{fitness} da EG. Na fase de validação o melhor mecanismo de seleção e o melhor critério de aceitação foram combinados e executados com todas as 11 instâncias descritas na Tabela \ref{tab:instancias}. 
	
	%TODO: escrever na metodologia sobre a funao de fitness escrever uma funcao bunitinha 

	

	
	
	\subsection{Resultados obtidos com EGHyPDP-1}
	\label{subsection:gehypdp1results}
	
	O melhor indivíduo (mecanismo de seleção gerado e critério de aceitação melhor ou igual) encontrado no experimento EGHyPSP-1 é apresentado na Equação \ref{eq:bestSelectionMechanism}
	
	\begin{equation}
	\label{eq:bestSelectionMechanism}
	RC * Ccurrent * Cava -Cr.
	\end{equation}
	

	
	Este mecanismo de seleção, juntamente com o critério de aceitação (melhor ou igual) foi executado novamente por 30 vezes com um tempo máximo de 30 minutos, porém utilizando todas as 11 instâncias disponíveis. A Tabela  \ref{tab:gexp1best} apresenta os resultados de média, desvio padrão, mínimo e máximo das execuções do melhor indivíduo apresentado na Equação \ref{eq:bestSelectionMechanism}. A última linha denota o melhor valor de energia conhecido para cada instância. Os valores destacados com negrito representam o indivíduo que obteve o melhor valor conhecido para determinada instância. É possível notar analisando as duas últimas linhas, que exceto para as instâncias 7,9,10 e 11, todas as outras instâncias, o indivíduo gerado conseguiu obter os melhores valores conhecidos. Dessa maneira, é possível observar que quando o tamanho das instâncias aumentam a qualidade dos resultados obtidos degrada.
	

	\begin{table}[]
		\centering
		\caption{Resultados da execução do melhor indivíduo encontrado pelo grupo de experimento EGHyPDP-1}
		\label{tab:gexp1best}
		\resizebox{\columnwidth}{!}{%
			\begin{tabular}{cccccccccccc}
				Instância  & 1   & 2    & 3   & 4    & 5    & 6   & 7   & 8    & 9    & 10   & 11   \\ \hline
				Média   & -8.1 & -7.6 & -6.7 & -11.9 & -17.4 & -16  & -30  & -28.3 & -40.1 & -35.6 & -35.9 \\ \hline
				Desvio Padrão & 0.3 & 0.5  & 0.5 & 0.7  & 1    & 1.4 & 1.7 & 2    & 2.7  & 2.1  & 2.9  \\ \hline
				Máximo   & -8   & -7    & -5   & -11   & -15   & -13  & -25  & -23   & -34   & -32   & -27   \\ \hline
				Mínimo   & \textbf{-9}   & \textbf{-9}    & \textbf{-8}   & \textbf{-14}   & \textbf{-23}   & \textbf{-21}  & -33  & \textbf{-42}   & -46   & -40   & -41   \\ \hline
				Melhor Valor de Energia   & \textbf{-9} & \textbf{-9} & \textbf{-8} & \textbf{-14} & \textbf{-23} & \textbf{-21} & \textbf{-36} & \textbf{-42} & \textbf{-53} & \textbf{-48} & \textbf{-50}  
			\end{tabular}
		}
	\end{table}
	
	\subsection{Resultados obtidos com EGHyPDP-2}
	O melhor indivíduo (mecanismo de seleção fixo e critério de aceitação gerado) encontrado no grupo de experimento EGHyPDP-2 é apresentado na Equação \ref{eq:bestAcceptanceCriteria}. O mecanismo de seleção utilizado foi o mesmo apresentado na Equação \ref{eq:bestSelectionMechanism}. A razão por usar este mecanismo de seleção foi: os resultados obtidos pelo melhor indivíduo da execução do EGHyPDP-1 se apresentaram promissores e o objetivo era gerar um um bom critério de aceitação que combinado com um mecanismo de seleção que funcione relativamente bem.
	 
	 \begin{equation}
	 \label{eq:bestAcceptanceCriteria}
	( ( TI / Delta ) / ( ( Delta * ( ( TI / Delta ) / CI ) * Delta / Delta * TI ) - CI ) )
	 \end{equation}
		 
	Este critério de aceitação, juntamente com o melhor mecanismo de seleção gerado pelo EGHyPDP-1, foram executados 30 vezes com um tempo máximo de 30 minutos utilizando as 11 instâncias disponíveis. A Tabela \ref{tab:gexp2best}  apresenta os resultados obtidos. Novamente, observando as duas ultimas linhas é possível verificar que em apenas em duas instâncias os melhores valores foram encontrados. Dessa maneira, é fácil notar que os resultados apresentados na Subseção \ref{subsection:gehypdp1results} obtiveram éxito em encontrar, para mais instâncias,  os melhores valores conhecidos. Vale mencionar, que o melhor mecanismo de seleção encontrado combinado com um critério de aceitação $"$melhor ou igual$"$  apresentou melhores resultados do que quando combinado com o melhor critério de aceitação gerado. 


	
	\begin{table}[]
		\centering
		\caption{Resultados da execução do melhor indivíduo encontrado no grupo de experimento EGHyPDP-2}
		\label{tab:gexp2best}
		\resizebox{\columnwidth}{!}{%
			\begin{tabular}{cccccccccccc}
				Instância  & 1   & 2   & 3   & 4    & 5    & 6    & 7   & 8    & 9    & 10   & 11  \\ \hline
				Média   & -8   & -7.6 & -6.7 & -10.1 & -14.8 & -14.7 & -27  & -25.7 & -38.3 & -32.8 & -30 \\ \hline
				Desvio Padrão & 0.6 & 0.4 & 0.6 & 0.7  & 1.5  & 1.4  & 2.0 & 2.5  & 3.3  & 3.7  & 3.4 \\ \hline
				Máximo   & -7   & -7   & -5   & -8    & -12   & -12   & -23  & -22   & -31   & -26   & -24  \\ \hline
				Mínimo   & \textbf{-9}   & -8   & \textbf{-8}   & -11   & -17   & -18   & -31  & -31   & -44   & -40   & -37  \\ \hline
				Melhor Valor de Energia   & \textbf{-9} & \textbf{-9} & \textbf{-8} & \textbf{-14} & \textbf{-23} & \textbf{-21} & \textbf{-36} & \textbf{-42} & \textbf{-53} & \textbf{-48} & \textbf{-50}
			\end{tabular}
		}
	\end{table}
	
	\subsection{Results from EGHyPDP-3}
	
	O melhor indivíduo gerado pelo grupo de experimento EGHyPDP-3 é composto por um mecanismo de seleção e um critério de aceitação. As Equações \ref{eq:bestSelectionMechanismWithAccept} e \ref{eq:bestSelectionMechanismWithAccept2} apresentam respectivamente o mecanismo de seleção e o critério de aceitação gerados.
	
	
	\begin{equation}
	\label{eq:bestSelectionMechanismWithAccept}
	( ( ( ( ( Caccept / RC ) * Cr / Caccept ) / RC * Cr ) / Caccept / RC ) * Cr ) / Caccept 
	\end{equation}
	
	
	\begin{equation}
	\label{eq:bestSelectionMechanismWithAccept2}
( ( ( ( ( CI / PF ) * Delta / CI ) / PF * Delta ) / CI / PF ) * Delta ) / CI
	\end{equation}
	
	
	A Tabela \ref{bestGExp3} apresenta os resultados da execução do mecanismo de seleção e do critério de aceitação gerados pelo grupo de experimentos EGHyPDP-3. Da mesma maneira, consistiram em 30 execuções com tempo máximo de 30 minutos. O valores destacados com negrito são os casos que o indivíduo alcançou os melhores valores conhecidos. É possível observar que apenas em dois casos isto ocorreu nas menores instâncias, entre 20 a 25 aminoácidos. Estas sequências são extremamente triviais levando apenas minutos para um  algoritmo genético encontrar as melhores soluções conhecidas. Dessa forma, é possível concluir que a geração de ambos as estratégias (seleção e aceitação), neste contexto, não apresentou bons resultados. 
	
	\begin{table}[]
		\centering
		\caption{Resultados da execução do melhor indivíduo encontrado no grupo de experimento EGHyPDP-3}
		\label{bestGExp3}
		\resizebox{\columnwidth}{!}{%
			\begin{tabular}{cccccccccccc}
				Instância  & 1   & 2   & 3   & 4   & 5    & 6    & 7   & 8    & 9    & 10  & 11   \\ \hline
				Média  & -7.6 & -7.0 & -5.7 & -9.7 & -13.8 & -12.7 & -24  & -24.2 & -31.6 & -27  & -26.4 \\ \hline
				Desvio Padrão & 0.6 & 0.7 & 0.8 & 0.9 & 1.3  & 0.9  & 1.1 & 1.6  & 1.7  & 1.7 & 2    \\ \hline
				Minímo   & -7   & -6   & -4   & -7   & -12   & -11   & -21  & -21   & -29   & -24  & -24   \\ \hline
				Máximo   & \textbf{-9}   &  -8  & \textbf{-8}   & -11  & -18   & -15   & -26  & -28   & -37   & -31  & -31   \\ \hline
				Melhor Valor de Energia   & \textbf{-9} & \textbf{-9} & \textbf{-8} & \textbf{-14} & \textbf{-23} & \textbf{-21} & \textbf{-36} & \textbf{-42} & \textbf{-53} & \textbf{-48} & \textbf{-50}
			\end{tabular}
		}
	\end{table}
	
	Após estes experimentos foi concluído que apenas a geração de mecanismos de seleção apresentou algum potencial. Os melhores resultados conhecidos foram obtidos em 7 instâncias de um total de 11, utilizando o melhor mecanismo de seleção encontrado. No caso dos critérios de aceitação os resultados não foram como esperados. A hipótese inicial era que combinadas as estratégias de seleção e aceitação esta se complementariam. Dessa maneira, possibilitando que o \textit{framework} hiper heurístico pudesse explorar de maneira adequada o espaço de busca. Apesar do resultado promissor obtido, gerando apenas mecanismos de seleção, é possível notar a perca de desempenho em instâncias maiores (64 a 100 aminoácidos). \cite{santana2008protein} menciona a grande quantidade de mínimos locais presentes no espaço de busca da instância 7. É questionável: se a falta de um critério de aceitação, melhor do que aceitar apenas soluções melhores ou iguais, pudesse guiar a busca afim de escapar dos mínimos locais. 

	
	
	\subsection{Comparação com \textit{framework} hiper heurístico GIHH}
	
	Com objetivo de comparar a melhor heurística de alto nível obtida pelo grupo de experimentos EGHyPDP-1 uma comparação com o \textit{framework} GIHH proposta por \cite{misir2012intelligent} foi realizada. O GIHH obteve os melhores resultados para 6  domínios distintos de problemas contidos no \textit{framework} HyFlex \cite{ochoa2012hyflex}. Misir disponibilizou o código fonte do GIHH e em seguida foram executados experimentos utilizando o problema PDP com o modelo HP-2D.
	
	A Tabela \ref{tab:gihhandbhlh} apresenta os melhores resultados encontrados pelos experimentos realizados com EGHyPDP, os resultados da execução do GIHH e por fim o melhor valor de energia conhecido. Os valores destacados com negrito são os melhores conhecidos. Tanto o EGHyPDP e o GIHH foram executados por 30 minutos. É possível verificar que em 7 instâncias de um total de 11 o EGHyPDP obteve os melhores valores conhecidos. Já o GIHH conseguiu obter os melhores valores apenas em 5 instâncias. Entretanto, se observamos as instâncias 7,9,10 e 11 o GIHH obteve valores mais próximos dos melhores do que o EGHyPDP. Dessa maneira, é possível afirmar que nas instâncias mais complexas o GIHH consegue chegar mais próximo dos melhores resultados conhecidos. No entanto, o EGHyPDP conseguiu encontrar os melhores valores em mais instâncias do que o GIHH. 
	
	\begin{table}[]
		\centering
		\caption{Os melhores resultados conhecidos e resultados encontrados com o EGHyPDP e GIHH.}
		\label{tab:gihhandbhlh}
		\begin{tabular}{cccccccccccc}
			Instância         & 1 & 2 & 3 & 4  & 5  & 6  & 7  & 8  & 9  & 10 & 11 \\ \hline
			EGHyPDP  & \textbf{-9}   & \textbf{-9}    & \textbf{-8}   & \textbf{-14}   & \textbf{-23}   & \textbf{-21}  & -33  & \textbf{-42}   & -46   & -40   & -41   \\ \hline
			GIHH   & \textbf{-9} & \textbf{-9} & \textbf{-8} & \textbf{-14} & -22 & \textbf{-21} & -35 & -37 & -49 & -43 & -45 \\ \hline
			Melhor Valor de Energia   & \textbf{-9} & \textbf{-9} & \textbf{-8} & \textbf{-14} & \textbf{-23} & \textbf{-21} & \textbf{-36} & \textbf{-42} & \textbf{-53} & \textbf{-48} & \textbf{-50}
		\end{tabular}
	\end{table}
	
	
	\subsection{Discussão}
	O EGHyPDP obteve êxito em gerar um mecanismo de seleção, que combinado com um critério de aceitação (melhor ou igual), obteve os melhores resultados em 7 instâncias. Entretanto, nas instâncias mais complexas os resultados obtidos são bem inferiores em relação aos melhores valores conhecidos. Também foi constatado que o EGHyPDP conseguiu gerar pelo menos um bom mecanismo de seleção, já no caso dos critérios de aceitação gerados nenhum apresentou bons resultados. Um novo experimento foi realizado para avaliar o comportamento dos critérios de aceitação. Este experimento consistiu em selecionar de maneira aleatória 10 indivíduos gerados pelo experimento EGHyPDP-2 e executá-los novamente para analisar o comportamento de cada um dos 10 critérios de aceitação.
	De 10 indivíduos 7, estavam  aceitando apenas soluções melhores ou iguais, da mesma maneira que o critério fixo que foi utilizado no primeiro experimento EGHyPDP-1. A única diferença entre os indivíduos gerados e o critério fixo: é que os indivíduos são mais lentos que o fixo pois é necessário executar uma expressão aritmética enquanto com o critério fixo, um simples $if$ é avaliado. Mas com respeito ao comportamento os critérios de aceitação são iguais. Outros 2 indivíduos dos 10 selecionados estavam aceitando qualquer solução pior do que a solução corrente da mesma maneira que o critério "todos movimentos" descrito por \cite{burke2013hyper}. Finalmente, um indivíduo não estava aceitando nunca soluções piores da mesma maneira que o critério "apenas melhorias"        
	 \cite{burke2013hyper}.
	
	Estes experimentos mostraram que o EGHyPDP conseguiu várias vezes gerar um critério de aceitação com exatamente o mesmo comportamento que critérios de aceitação desenvolvidos por pesquisadores. Entretanto, estes critérios são muito simples e não são suficientes para possibilitar que a busca não fique travada em mínimos locais. Levando em consideração que os experimentos envolvendo geração de critérios de aceitação (EGHyPDP-2 e EGHyPDP-3) não obtiveram resultados competitivos. 
	
	
	\subsection{Conclusão dos experimentos utilizando o EGHyPDP}
	
	Esta seção apresentou os experimentos realizados com EGHyPDP, uma ferramenta automática para gerar heurísticas de alto nível para um \textit{framework} hiper heurístico para resolver o problema PDP com o modelo HP-2D. O PDP é um problema muito desafiador com uma grande quantidade de mínimos locais e um espaço de busca complexo. 
	
		Muitos estudos exploraram o PDP com modelos simplificados, tais como modelo HP-2D, utilizando métodos heurísticos. Embora, é comum que estratégias heurísticas não consigam obter os melhores resultados conhecidos no caso das maiores instâncias. Geralmente, os \textit{frameworks} hiper heurísticos se adaptam bem a este tipo de contexto complexo. Consequentemente, o objetivo desta abordagem foi gerar mecanismos de seleção e critérios de aceitação, através de um processo de evolução gramatical, de um \textit{framework} hiper heurístico. Tal \textit{framework} foi utilizado para resolver o PDP utilizando o modelo HP-2D. O desempenho e comportamento das heurísticas de alto nível geradas foi avaliado executando o \textit{framework} utilizando um conjunto de 11 instâncias. 
		Trés grupos de experimentos foram desenvolvidos: o primeiro grupo apenas gerou mecanismos de seleção e utilizou um critério de aceitação "melhor ou igual"; o segundo gerou apenas critérios de aceitação. E no caso do mecanismo de seleção foi utilizado o melhor gerado pelo primeiro grupo; O terceiro e último grupo gerou tanto mecanismos de seleção e critérios de aceitação em paralelo. Os resultados obtidos pelos experimentos demonstram que a melhor heurística de alto nível foi encontrada no primeiro grupo. Já os resultados obtidos com o segundo e terceiro grupo não são expressivos. Analisando, o melhor resultado obtido pelo primeiro experimento (um mecanismo de seleção e o critério de aceitação "melhor ou igual") é possível notar que de 11 instâncias em 7 casos foram encontrados os melhores resultados conhecidos. Entretanto, nas maiores instâncias (7,9,10 e 11) os resultados foram inferiores aos melhores conhecidos. 
		O melhor indivíduo gerado também foi comparado com o GIHH, um \textit{framework} hiper heurístico do estado da arte, os resultados obtidos por ambos são ligeiramente próximos. Em 5 instâncias o GIHH conseguiu obter os melhores resultados conhecidos. No caso da instâncias 7,9,10 e 11 o GIHH nao conseguiu encontrar os melhores resultados, mas encontrou resultados supeiores ao EGHyPDP. Isto demonstra que é possível automatizar o \textit{design} de heurísticas de alto nível. E obter resultados próximos aos de uma estratégia hiper heurística com capacidade de obter bons resultados, em outros domínios de problema.
		
		Outra constatação deste estudo foi o comportamento do critérios de aceitação gerados. Foi notado que uma parte dos critérios de aceitação gerados se comportavam da mesma maneira que o critério "melhor ou igual". Também foram gerados critérios que sempre aceitam e que nunca aceitam soluções piores, da mesma maneira que os critérios "todos os movimentos" e "apenas melhorias" respectivamente. Dessa forma, foi possível constatar que os critérios gerados se comportam da mesma maneira que alguns critérios simples, mas que foram desenvolvidos por cientistas. Entretanto, o EGHyPDP não foi capaz de gerar critérios de aceitação que possibilitassem escapar dos mínimos locais de um espaço de busca complexo como o do PDP.

	
	
